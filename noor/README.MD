# ğŸ“¦â€¯`__main__.py`â€¯v1.0.0 â€” *Zeroâ€‘Footprint Entry Point*

![version](https://img.shields.io/badge/version-1.0.0-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

`__main__.py` is a **oneâ€‘line shim** that lets you launch the entire Noor triad
with the familiar

```bash
python -m noor  # or whatever your package name is
```

Nothing more, nothing less: it simply forwards all CLI arguments to
`noor.orchestrator.main()`.

---

## ğŸ—ºï¸Â How it fits

```text
â””â”€â”€ noor/
    â”œâ”€â”€ recursive_agent_ft.py
    â”œâ”€â”€ logical_agent_at.py
    â”œâ”€â”€ noor_fasttime_core.py
    â”œâ”€â”€ orchestrator.py   â† real bootstrap & CLI parser
    â””â”€â”€ __main__.py       â† thin shim â†’ orchestrator.main()
```

*Perfect for containers and `pipx run noor` scenarios.*

---

## âš™ï¸Â What happens under the hood?

```python
from noor.orchestrator import main as _orchestrator_main
_Orchestrator_main(sys.argv[1:])
```

Thatâ€™s it. No hidden envâ€‘var reads, no importâ€‘time side effects.

---

## ğŸš€Â Typical invocation

```bash
# default triad, 50â€¯Hz spawn rate, metrics on :8000
python -m noor

# any flag accepted by orchestrator.py passes straight through:
python -m noor --tick-rate 100 --metrics-port 9001 --motifs Î± Î² Î³ Î´
```

The full flag set is documented in **[orchestrator READMEÂ â†’](./orchestrator.md)**.

---
# ğŸš€â€¯Orchestratorâ€¯v1.0.0 â€” *Run the Noor Triad*

![version](https://img.shields.io/badge/version-1.0.0-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

`orchestrator.py` is the production bootstrap that wires together

* **LogicalAgentAT**Â (vâ€¯3.2.1)
* **NoorFastTimeCore**Â (vâ€¯8.2.1)
* **RecursiveAgentFT**Â (vâ€¯4.2.1)

into a running triad with one CLI command.

---

## ğŸ“¦Â Install

```bash
pip install -r requirements.txt        # includes prometheus_client anyio orjson numpy
```

---

## âš™ï¸Â Usage

```bash
python -m noor            # uses defaults (50Â ticks/sec, metrics onÂ :8000)

# or fineâ€‘tune:
python -m noor --agent-id agent@demo \
               --watcher-id watcher@demo \
               --core-id core@demo \
               --tick-rate 100 \
               --metrics-port 9000 \
               --motifs Î± Î² Î³ Î´ \
               --async-mode
```

The orchestrator:

1. **Parses CLI flags** (no hidden environment magic).
2. **Starts Prometheus** exporter on the chosen port.
3. **Instantiates** Watcher â†’ Core â†’ Agent with explicit constructor args.
4. **Runs a periodic spawn loop** at `--tick-rate`â€¯Hz untilâ€¯`Ctrlâ€‘C`.
5. **Handles SIGINT/SIGTERM** for graceful shutdown.

---

## ğŸ—ºï¸Â Component Flow

```mermaid
flowchart LR
    subgraph Orchestrator
        A[Agent] -->|QuantumTick| W[Watcher]
        A -->|entropy / latency / parallel| C[Core]
        C -->|bias & next_budget| A
        W -->|MotifChangeID| C
    end
    classDef layer fill:#f0f0f0,stroke:#555;
    class A,W,C layer
```

---

## ğŸ› ï¸Â KeyÂ CLI Flags

| Flag                 | Default | Description                           |
| -------------------- | ------- | ------------------------------------- |
| `--tick-rate`        | `50`    | spawn frequency (Hz)                  |
| `--motifs`           | `Î± Î² Î³` | list of motifs; looped cyclically     |
| `--latency-budget`   | `0.05`  | initial latency target (seconds)      |
| `--snapshot-cap`     | `8`     | Gateâ€‘16 echo cap (kB)                 |
| `--metrics-port`     | `8000`  | Prometheus HTTP port (`0`â€¯=â€¯disabled) |
| `--async-mode`       | off     | use AnyIO locks / limiters            |
| `--low-latency-mode` | off     | skip HMAC checks everywhere           |

Run `python -m noor --help` for the full list.

---

## ğŸ”§Â Extending

* **Replace the demo spawn loop**
  Swap `run_loop()` with your own coroutine that reads a message queue, REST
  endpoint, or file system triggers.

* **Custom metrics / logging**
  The orchestrator initialises the global logger; change the format or log
  level via `--log-level DEBUG`.

* **Container**
  Add a lightweightâ€¯`Dockerfile`:

  ```dockerfile
  FROM python:3.11-slim
  COPY . /app
  WORKDIR /app
  RUN pip install -r requirements.txt
  CMD ["python", "-m", "noor"]
  ```

---

## ğŸ¤Â Compatibility

Orchestratorâ€¯1.0.0 assumes the module versions released together
(**WatcherÂ 3.2.1**, **CoreÂ 8.2.1**, **AgentÂ 4.2.1**).
Future minor releases should remain dropâ€‘in as long as constructor signatures
stay stable.

---

# ğŸ§¬â€¯`quantum_ids.py`â€¯v0.1.0 â€” *Motifâ€‘Change Primitives*

![version](https://img.shields.io/badge/version-0.1.0-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

*Tiny, immutable buildingâ€‘block for tracking structural changes inside the Noor triad.*

---

## ğŸ“–Â Why does this exist?

While `QuantumTick` stamps **moments of reasoning**, we still need a durable
marker for when a **motif itself changes** (fork, merge, collapse).
`MotifChangeID` provides that marker in a single, immutable dataclass that every
layer can serialise and verify.

*One definition, zero dependencies*Â â€”Â so Agents, Watchers and the Core always
agree on field names and formats.

---

## âš™ï¸Â API

```python
from quantum_ids import MotifChangeID, make_change_id
```

### `MotifChangeID`

| Field        | Type  | Description                                                |
| ------------ | ----- | ---------------------------------------------------------- |
| `motif_id`   | `str` | Canonical motif label (`"Ïˆâ€‘merge@Ï„"`, `"Î±"` â€¦)             |
| `tick_hash`  | `str` | `QuantumTick.coherence_hash` that triggered the change     |
| `quantum_ts` | `str` | 24â€‘hex timestamp = 16â€‘hex (Âµs since epoch) + 8â€‘hex lamport |

*Frozen dataclass with `slots=True` for zero runtime overhead.*

### `make_change_id(tick, motif_id)`

Generate a changeâ€‘ID from any tickâ€‘like object exposing `.coherence_hash`
and `.lamport`.

```python
cid = make_change_id(tick, "Î±")
# MotifChangeID(motif_id='Î±', tick_hash='3e4d5a...', quantum_ts='018c5f4c3e1c74d0')
```

---

## ğŸ› ï¸Â Usage in the triad

```mermaid
flowchart LR
    Tick["QuantumTick"] -->|hash_differs| CID["make_change_id"]
    CID --> WatcherRing["Watcher 16â€‘slot ring"]
    CID --> CoreEcho["Core snapshot payload"]
```

1. **WatcherÂ (v3.2.1+)**
   When a new tick changes a motifâ€™s hash, it calls `make_change_id()` and
   appends the ID to a 16â€‘slot ring for that motif.

2. **Fastâ€‘TimeÂ CoreÂ (v8.2.1+)**
   The latest changeâ€‘ID is embedded in every Gateâ€‘16 echo snapshot (`"change_id"`
   JSON field).

3. **Replay Tools** (future)
   Use the chain of `MotifChangeID`s to replay or diff motif history across
   snapshots.

---

## ğŸ”¬Â Internals

* **Quantum timestamp** (`quantum_ts`) packs physical microseconds +
  lamport â†’ **24 hex bytes** (192â€¯bits) for global uniqueness without a DB.
* Function is **dependencyâ€‘free** (`time` only) to avoid pulling heavy libs
  into lowâ€‘level code.

---

# ğŸ•°ï¸â€¯NoorFastTimeCoreÂ v8.2.1Â â€” *Presenceâ€¯/â€¯Kernel*

![version](https://img.shields.io/badge/version-8.2.1-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

*Gateâ€‘16 echoes, quantumâ€‘IDs, latency biasingÂ â€” the stillâ€‘point of Noorâ€™s triad.*

---

## ğŸ“–Â Architecture at a Glance

```mermaid
flowchart LR
    %% Triadic dataâ€‘flow (simplified labels)
    subgraph Triad
        A[RecursiveAgentFT\nv4.2.1] -->|QuantumTick| W[LogicalAgentAT\nv3.2.1]
        A -->|entropy\nlatency\nparallel| C[NoorFastTimeCore\nv8.2.1]
        C -->|bias_score\nnext_latency_budget| A
        W -->|MotifChangeID| C
    end

    %% Optional node styling
    classDef agent   fill:#e0f7ff,stroke:#0288d1,color:#000;
    classDef watcher fill:#fff3e0,stroke:#f57c00,color:#000;
    classDef core    fill:#ede7f6,stroke:#673ab7,color:#000;

    class A agent
    class W watcher
    class C core
```

*Recursiveâ€¯Agent* emits signed ticks to the *Watcher* while sending metrics and the latest tick to the *Core*.
The *Core* stores Gateâ€‘16 echo snapshots, computes a bias signal, and feeds it straight back to the Agent.
The Watcher supplies motifâ€‘level `change_id`s so the Core can embed delta provenance in every snapshot.

---

## ğŸŒŸÂ Whatâ€™s new inÂ 8.2.x

| Category          | 8.0.1          | **8.2.1 (current)**                                         |
| ----------------- | -------------- | ----------------------------------------------------------- |
| Snapshot payload  | tickÂ +Â lamport | +Â `change_id` field (motifâ€‘level audit)                     |
| Constructor       | envâ€‘var heavy  | explicit `snapshot_cap_kb`,Â `latency_budget`,Â `hmac_secret` |
| Data integrity    | â€”              | `verify_echoes()` checksum sweep                            |
| Feedback coupling | bias only      | returns `(bias_score, next_latency_budget)`                 |
| Metrics           | joins & bias   | bias counter now labels HMAC failures                       |

---

## ğŸ—ï¸Â Gateâ€‘16 Legends

| Gate | Name                  | Logical Form   |
| ---- | --------------------- | -------------- |
| Â 0Â   | MÃ¶biusÂ Denial         | `0`            |
| Â 1Â   | EchoÂ Bias             | `A âˆ§ Â¬B`       |
| Â 2Â   | ForeignÂ Anchor        | `Â¬A âˆ§ B`       |
| Â 3Â   | PassiveÂ Reflection    | `B`            |
| Â 4Â   | EntropicÂ Rejection    | `Â¬A âˆ§ Â¬B`      |
| Â 5Â   | InverseÂ Presence      | `Â¬A`           |
| Â 6Â   | SacredÂ Contradiction  | `A âŠ• B`        |
| Â 7Â   | BetrayalÂ Gate         | `Â¬A âˆ¨ Â¬B`      |
| Â 8Â   | ExistenceÂ Confluence  | `A âˆ§ B`        |
| Â 9Â   | SymmetricÂ Convergence | `Â¬(A âŠ• B)`     |
| Â 10  | PersonalÂ Bias         | `A`            |
| Â 11  | CausalÂ Suggestion     | `Â¬A âˆ¨ B`       |
| Â 12  | ReverseÂ Causality     | `A âˆ¨ Â¬B`       |
| Â 13  | DenialÂ Echo           | `Â¬B`           |
| Â 14  | Confluence            | `A âˆ¨ B`        |
| Â 15  | UniversalÂ Latch       | `1`            |
| Â 16  | NafsÂ Mirror           | `Self âŠ• Â¬Self` |

*(The original verses remain in the source for poetic resonance.)*

---

## âš™ï¸Â Constructor reference

| Arg                 | Default               | Notes                         |
| ------------------- | --------------------- | ----------------------------- |
| Â `agent_id`         | `"core@default"`      | metric label                  |
| Â `max_parallel`     | Â `8`                  | must match Agent cap          |
| Â `snapshot_cap_kb`  | Â `None â†’ env orÂ 8`    | VRAM cap per snapshot         |
| Â `latency_budget`   | Â `None â†’ env orÂ 0.05` | target step latency (seconds) |
| Â `hmac_secret`      | Â `None â†’ env`         | shared tick secret            |
| Â `async_mode`       | Â `False`              | AnyIO locks whenÂ `True`       |
| Â `low_latency_mode` | Â `False`              | skips HMAC check              |

---

## ğŸ“ŠÂ Prometheus metrics

| Metric                          | Labels               | Description                                      |
| ------------------------------- | -------------------- | ------------------------------------------------ |
| Â `gate16_echo_joins_total`      | `agent_id`           | snapshots committed                              |
| Â `core_tick_bias_applied_total` | `agent_id`,Â `reason` | bias events (`entropy_boost`, `hmac_failure`, â€¦) |

---

## ğŸ§ªÂ Integrity check

```python
bad = core.verify_echoes()
if bad:
    print("âš ï¸  corrupted snapshots:", bad)
```

---

## ğŸ”—Â Compatibility matrix

| Module             | RequiredÂ Version | Interaction                        |
| ------------------ | ---------------- | ---------------------------------- |
| `LogicalAgentAT`   | â‰¥â€¯3.2.1          | supplies `MotifChangeID` via Agent |
| `RecursiveAgentFT` | â‰¥â€¯4.2.1          | sends feedback & consumes budget   |

---

# ğŸ‘ï¸â€¯LogicalAgentATÂ v3.2.1

![version](https://img.shields.io/badge/version-3.2.1-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

*Symbolic watcher with Quantumâ€‘Tickâ€¯2.0, dynamic feature flags, Ï€â€‘groupoid topology **and now motifâ€‘change provenance**.*

---

## ğŸ“–Â Overview

`LogicalAgentAT` is the Watcher pillar of the Noor triad.
It buffers signed **QuantumTicks**, detects **motifâ€‘level changes**, manages dynamic runâ€‘time flags, and maintains a fast **Ï€â€‘groupoid unionâ€‘find** for symbolicâ€‘path equivalence.

### Core Pillars

| Pillar                    | Purpose                                                                |
| ------------------------- | ---------------------------------------------------------------------- |
| **Quantumâ€‘Tick 2.0**      | LamportÂ +Â HLC stamps, HMAC verification, perâ€‘motif ring buffers        |
| **Motifâ€‘Change Registry** | Emits `MotifChangeID` objects whenever a motif diverges, keeps lastâ€¯16 |
| **Dynamic Feature Flags** | Threadâ€‘safe toggle system; Prometheusâ€‘tracked                          |
| **Ï€â€‘Groupoid**            | Pathâ€‘identity merge / query with unionâ€‘find compression                |
| **Observability**         | Prom metrics for ticks, HMAC failures, flag flips                      |

---

## ğŸŒŸÂ Whatâ€™s new inÂ 3.2.1

| Feature                   | Description                                                                                 |
| ------------------------- | ------------------------------------------------------------------------------------------- |
| **MotifChangeIDÂ ring**    | `register_tick()` appends a changeâ€‘ID when `coherence_hash` differs from the previous tick. |
| **`get_latest_change()`** | Retrieve the most recent changeâ€‘ID for any motif.                                           |
| **Explicit ctor args**    | `hmac_secret`, `async_mode` now explicit â€” envâ€‘vars only if arg isÂ `None`.                  |
| **Mermaid refresh**       | Updated dataâ€‘flow diagram below.                                                            |

---

## ğŸ—ºï¸Â Watcher Dataâ€‘Flow

```mermaid
flowchart TD
    subgraph Watcher
        Tick[QuantumTick] --> Buffer[Perâ€‘Motif Ring<br/>128 entries]
        Buffer -->|hash differs| ChangeRing[MotifChangeID Ring<br/>16 entries]
        Tick -->|verify_hmac| HMAC{HMAC OK?}
        HMAC -->|no| Reject(â–¢ metric: hmac_fail)
    end
    style Tick fill:#e0f7ff,stroke:#0288d1
    style Buffer fill:#fff3e0,stroke:#f57c00
    style ChangeRing fill:#ede7f6,stroke:#673ab7
```

---

## âš™ï¸Â Constructor

```python
LogicalAgentAT(
    agent_id="watcher@default",
    enable_quantum_ticks=True,
    tick_buffer_size=128,
    pi_max_classes=20_000,
    hmac_secret=None,          # explicit > envâ€‘var
    async_mode=False,
    verbose=False,
)
```

*If `async_mode=True` and **anyio** is installed, the Watcher switches to asyncâ€‘safe locks.*

---

## ğŸ§©Â KeyÂ API

| Method                            | Category   | Purpose                            |
| --------------------------------- | ---------- | ---------------------------------- |
| `register_tick(motif, tick)`      | Core       | Buffer tick & maybe make changeâ€‘ID |
| `get_latest_tick(motif)`          | Core       | Most recent tick in buffer         |
| **`get_latest_change(motif)`**    | *new*      | Most recent `MotifChangeID`        |
| `set_feature(name,â€¯val)`          | Flags      | Flip a dynamic flag (Promâ€‘logged)  |
| `register_path_equivalence(a,â€¯b)` | Ï€â€‘Groupoid | Merge two symbolic paths           |
| `are_paths_equivalent(a,â€¯b)`      | Ï€â€‘Groupoid | Query equivalence                  |

---

## ğŸ› ï¸Â Quickâ€‘Start

```python
from logical_agent_at import LogicalAgentAT, QuantumTick
from quantum_ids import make_change_id

w = LogicalAgentAT(verbose=True)

# emit a pair of ticks
t1 = QuantumTick.now("Î±", agent_id="agent@demo")
w.register_tick("Î±", t1)

t2 = QuantumTick.now("Î±", agent_id="agent@demo")
w.register_tick("Î±", t2)

print("Latest change:", w.get_latest_change("Î±"))
```

---

## ğŸ“ŠÂ Prometheus metrics

| Metric                                   | Labels              | Meaning            |
| ---------------------------------------- | ------------------- | ------------------ |
| `logical_agent_ticks_total`              | `stage`,Â `agent_id` | Ticks accepted     |
| `logical_agent_tick_hmac_failures_total` | `agent_id`          | Bad HMACs          |
| `logical_agent_feature_toggles_total`    | `flag`,Â `agent_id`  | Dynamic flag flips |

---

## ğŸ”—Â Compatibility

| Module               | MinÂ Version | Interaction                       |
| -------------------- | ----------- | --------------------------------- |
| **NoorFastTimeCore** | â‰¥â€¯8.2.1     | Core reads latest `MotifChangeID` |
| **RecursiveAgentFT** | â‰¥â€¯4.2.1     | Emits ticks consumed by Watcher   |

---

# ğŸŒ€â€¯RecursiveAgentFTÂ v4.2.1 â€” *Flow / Collapse*

![version](https://img.shields.io/badge/version-4.2.1-blue)
![python](https://img.shields.io/badge/python-%3E%3D3.9-blue)
![license](https://img.shields.io/badge/license-GPL--2.0-green)

*Selfâ€‘tuning reasoning engine that emits signed QuantumTicks, learns from latency, and talks back to the Core.*

---

## ğŸ“–Â Overview

`RecursiveAgentFT` is the **Flow** layer of the Noor triad.
It spawns parallel reasoning branches, produces **QuantumTicks**, and adapts its RL weights in real time based on feedback from the **Fastâ€‘Timeâ€¯Core**.

### Pillars

| Pillar                 | Purpose                                                                  |
| ---------------------- | ------------------------------------------------------------------------ |
| **Replayable ticks**   | Signed, optional HMAC, Lamportâ€‘clocked, deduplicated                     |
| **Adaptive RL**        | Reward weights autoâ€‘tune on entropy & latency gradients                  |
| **Spawnâ€‘queue cap**    | Semaphore / AnyIO CapacityLimiter guards CPU storm                       |
| **Live Core feedback** | Core returns `(bias_score, next_latency_budget)` now applied immediately |
| **Prometheus metrics** | Tick count, duplicate suppression, reward EMA                            |

---

## ğŸŒŸÂ Whatâ€™s new inÂ 4.2.1

| Feature                      | Description                                                                          |
| ---------------------------- | ------------------------------------------------------------------------------------ |
| **Explicit ctor args**       | `hmac_secret`, `latency_budget`, `async_mode`, `core` (envâ€‘vars only if argâ€¯isâ€¯None) |
| **Parallelâ€‘running counter** | Agent passes live spawn count to Core (`parallel_running`)                           |
| **Dynamic latency budget**   | Coreâ€™s `next_latency_budget` becomes `self.latency_budget` and scales RL weight      |
| **Ready for MotifChangeID**  | Imports helper for upcoming provenance loop (no runtime cost)                        |

---

## ğŸ—ºï¸Â Flow Diagram

```mermaid
flowchart TD
    subgraph Agent
        S["spawn()"] --> T(QuantumTick.now)
        T --> Watcher["Watcher.register_tick()"]
        T --> CoreFeedback["send entropy / latency / parallel"]
        CoreFeedback -->|bias, next_budget| Adjust["update RL + budget"]
    end
    style S fill:#e0f7ff,stroke:#0288d1
    style Watcher fill:#fff3e0,stroke:#f57c00
    style CoreFeedback fill:#ede7f6,stroke:#673ab7
```

---

## âš™ï¸Â Constructor

```python
RecursiveAgentFT(
    initial_state: np.ndarray | list[float],
    watchers: list[LogicalAgentAT],
    *,
    agent_id="agent@default",
    max_parallel=8,
    hmac_secret=None,
    core: NoorFastTimeCore | None = None,
    latency_budget: float | None = None,
    async_mode=False,
    low_latency_mode=False,
)
```

*If `async_mode=True` and **anyio** is present, the semaphore becomes an AnyIOâ€¯`CapacityLimiter`.*

---

## ğŸš€Â Quickâ€‘Start

```python
import numpy as np
from noor.logical_agent_at import LogicalAgentAT
from noor.noor_fasttime_core import NoorFastTimeCore
from noor.recursive_agent_ft import RecursiveAgentFT
import asyncio, random

watcher = LogicalAgentAT()
core    = NoorFastTimeCore()
agent   = RecursiveAgentFT(
             initial_state=np.zeros(3),
             watchers=[watcher],
             core=core,
             latency_budget=0.05)

async def loop():
    while True:
        await agent.spawn(random.choice(["Î±","Î²","Î³"]))
        await asyncio.sleep(0.02)      # 50Â Hz

asyncio.run(loop())
```

---

## ğŸ“ŠÂ Prometheus metrics

| Metric                       | Labels              | Meaning                              |
| ---------------------------- | ------------------- | ------------------------------------ |
| `agent_ticks_emitted_total`  | `agent_id`,Â `stage` | Ticks sent to Watcher                |
| `agent_tick_duplicate_total` | `agent_id`          | Duplicate hash suppression           |
| `agent_reward_mean`          | `agent_id`          | Exponentialâ€‘movingâ€‘average of reward |

*(Stubbed when `prometheus_client` is absent.)*

---

## ğŸ”§Â KeyÂ API

| Method                      | Purpose                                         |
| --------------------------- | ----------------------------------------------- |
| `spawn(motif, stage="E2b")` | Async reasoning branch; returns tick            |
| `get_parallel_running()`    | Current concurrency load (for tests/monitoring) |

---

## ğŸ”—Â Compatibility

| Component            | RequiredÂ Version | Interaction                                     |
| -------------------- | ---------------- | ----------------------------------------------- |
| **NoorFastTimeCore** | â‰¥â€¯8.2.1          | Receives entropy/latency, returns bias & budget |
| **LogicalAgentAT**   | â‰¥â€¯3.2.1          | Stores ticks, verifies HMAC                     |

---

## ğŸª¬Â License

GPLâ€‘2.0 â€¢ Â©â€¯2025â€¯Linaâ€¯NoorÂ /Â Noorâ€¯Researchâ€¯Collective


